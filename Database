CREATE DATABASE alumni_network_db;

USE alumni_network_db;

CREATE TABLE users (
    user_id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    email VARCHAR(100) NOT NULL UNIQUE,
    password_hash VARCHAR(255) NOT NULL,
    role ENUM('alumni', 'student', 'admin') NOT NULL,
    batch_year YEAR,
    current_job VARCHAR(100),
    company VARCHAR(100),
    location VARCHAR(100),
    profile_picture VARCHAR(255),
    bio TEXT,
    skills TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

-- Events Table
CREATE TABLE events (
    event_id INT AUTO_INCREMENT PRIMARY KEY,
    title VARCHAR(200) NOT NULL,
    description TEXT,
    date DATE NOT NULL,
    time TIME,
    location VARCHAR(200),
    created_by INT NOT NULL,
    event_type ENUM('webinar', 'reunion', 'networking', 'workshop') NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (created_by) REFERENCES users(user_id) ON DELETE CASCADE
);

-- Mentorship Table
CREATE TABLE mentorship (
    mentorship_id INT AUTO_INCREMENT PRIMARY KEY,
    mentor_id INT NOT NULL,
    mentee_id INT NOT NULL,
    status ENUM('requested', 'approved', 'completed', 'cancelled') DEFAULT 'requested',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (mentor_id) REFERENCES users(user_id) ON DELETE CASCADE,
    FOREIGN KEY (mentee_id) REFERENCES users(user_id) ON DELETE CASCADE,
    UNIQUE KEY unique_mentorship (mentor_id, mentee_id)
);

-- Posts/Activity Feed Table
CREATE TABLE posts (
    post_id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    content TEXT NOT NULL,
    post_type ENUM('event', 'job', 'update', 'achievement', 'announcement') NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE CASCADE
);

-- Indexes for better performance
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_role ON users(role);
CREATE INDEX idx_users_batch_year ON users(batch_year);
CREATE INDEX idx_events_date ON events(date);
CREATE INDEX idx_events_created_by ON events(created_by);
CREATE INDEX idx_events_type ON events(event_type);
CREATE INDEX idx_mentorship_mentor ON mentorship(mentor_id);
CREATE INDEX idx_mentorship_mentee ON mentorship(mentee_id);
CREATE INDEX idx_mentorship_status ON mentorship(status);
CREATE INDEX idx_posts_user ON posts(user_id);
CREATE INDEX idx_posts_type ON posts(post_type);
CREATE INDEX idx_posts_created_at ON posts(created_at);


--Mentorship topics/skills
CREATE TABLE mentorship_topics (
    topic_id INT AUTO_INCREMENT PRIMARY KEY,
    mentorship_id INT NOT NULL,
    topic_name VARCHAR(100),
    FOREIGN KEY (mentorship_id) REFERENCES mentorship(mentorship_id)
);

--mentorship feedback
CREATE TABLE mentorship_feedback (
    feedback_id INT AUTO_INCREMENT PRIMARY KEY,
    mentorship_id INT NOT NULL,
    given_by INT NOT NULL,   -- mentee_id
    rating INT CHECK (rating BETWEEN 1 AND 5),
    comments TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (mentorship_id) REFERENCES mentorship(mentorship_id),
    FOREIGN KEY (given_by) REFERENCES users(user_id)
);

-- Insert Users (Alumni, Students, Admin)
INSERT INTO users (name, email, password_hash, role, batch_year, current_job, company, location, profile_picture, bio, skills) VALUES
('John Smith', 'john.smith@email.com', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'alumni', 2018, 'Software Engineer', 'Google', 'San Francisco, CA', 'john_profile.jpg', 'Passionate software engineer with 5 years of experience in full-stack development.', 'JavaScript, Python, React, Node.js, AWS'),

('Sarah Johnson', 'sarah.johnson@email.com', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'alumni', 2017, 'Product Manager', 'Microsoft', 'Seattle, WA', 'sarah_profile.jpg', 'Product manager focused on AI and machine learning solutions.', 'Product Management, AI/ML, Data Analysis, Agile'),

('Mike Chen', 'mike.chen@email.com', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'alumni', 2019, 'Data Scientist', 'Netflix', 'Los Angeles, CA', 'mike_profile.jpg', 'Data scientist specializing in recommendation systems and user behavior analysis.', 'Python, R, Machine Learning, SQL, Tableau'),

('Emily Davis', 'emily.davis@email.com', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'student', 2024, NULL, NULL, 'Boston, MA', 'emily_profile.jpg', 'Final year computer science student interested in web development.', 'HTML, CSS, JavaScript, Python, Git'),

('Alex Rodriguez', 'alex.rodriguez@email.com', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'student', 2025, NULL, NULL, 'Austin, TX', 'alex_profile.jpg', 'Third year student passionate about mobile app development.', 'Java, Kotlin, Swift, Android Development, iOS Development'),

('Admin User', 'admin@university.edu', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'admin', NULL, 'System Administrator', 'University', 'Campus', 'admin_profile.jpg', 'Managing the alumni network platform.', 'System Administration, Database Management'),

('Lisa Wang', 'lisa.wang@email.com', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'alumni', 2016, 'UX Designer', 'Adobe', 'San Jose, CA', 'lisa_profile.jpg', 'Creative UX designer with expertise in user research and design thinking.', 'UX/UI Design, Figma, User Research, Prototyping'),

('David Brown', 'david.brown@email.com', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'alumni', 2020, 'Startup Founder', 'TechStart Inc.', 'New York, NY', 'david_profile.jpg', 'Entrepreneur and startup founder in the fintech space.', 'Entrepreneurship, Fintech, Leadership, Business Development');

-- Insert Events
INSERT INTO events (title, description, date, time, location, created_by, event_type) VALUES
('Annual Alumni Reunion 2025', 'Join us for our biggest alumni gathering of the year! Reconnect with old friends and make new connections.', '2025-10-15', '18:00:00', 'University Main Auditorium', 6, 'reunion'),

('Career Development Webinar', 'Learn about the latest trends in tech careers and how to advance your professional journey.', '2025-09-28', '14:00:00', 'Online - Zoom Link', 1, 'webinar'),

('Startup Pitch Night', 'Alumni entrepreneurs present their startups to fellow graduates and potential investors.', '2025-11-05', '19:00:00', 'Innovation Center Hall B', 8, 'networking'),

('Machine Learning Workshop', 'Hands-on workshop covering practical ML applications in industry.', '2025-10-12', '10:00:00', 'Computer Science Building Room 201', 3, 'workshop'),

('Alumni Networking Mixer', 'Casual networking event for alumni in the San Francisco Bay Area.', '2025-09-30', '18:30:00', 'SF Tech Hub, Downtown', 1, 'networking'),

('UX Design Masterclass', 'Advanced UX design techniques and industry best practices.', '2025-11-20', '13:00:00', 'Design Studio, Campus', 7, 'workshop');

-- Insert Mentorship Records
INSERT INTO mentorship (mentor_id, mentee_id, status) VALUES
(1, 4, 'approved'),  -- John Smith mentoring Emily Davis
(2, 5, 'approved'),  -- Sarah Johnson mentoring Alex Rodriguez  
(3, 4, 'requested'), -- Mike Chen requested by Emily Davis
(7, 5, 'approved'),  -- Lisa Wang mentoring Alex Rodriguez
(8, 4, 'requested'), -- David Brown requested by Emily Davis
(1, 5, 'completed'), -- John Smith completed mentorship with Alex Rodriguez
(2, 4, 'requested'); -- Sarah Johnson requested by Emily Davis

-- Insert Posts/Activity Feed
INSERT INTO posts (user_id, content, post_type) VALUES
(1, 'Excited to announce that I just got promoted to Senior Software Engineer at Google! Grateful for all the support from my alma mater.', 'update'),

(2, 'Just posted a new job opening for Product Manager at Microsoft. Check out our careers page if you''re interested in AI/ML products!', 'job'),

(6, 'Reminder: Annual Alumni Reunion registration is now open! Early bird pricing ends next week.', 'event'),

(3, 'Had an amazing time presenting at the Data Science Conference. The future of recommendation systems looks bright!', 'achievement'),

(8, 'Our startup just closed Series A funding! Looking to hire talented engineers. DM me if you''re interested.', 'job'),

(7, 'Excited to be conducting a UX Design Masterclass next month. Limited spots available, register soon!', 'event'),

(4, 'Looking for internship opportunities in web development. Would appreciate any leads or advice!', 'update'),

(5, 'Just finished my mobile app project - a campus food delivery app. Thanks to my mentors for the guidance!', 'achievement'),

(1, 'Hosting a career development webinar next week. Will share insights about breaking into big tech companies.', 'event'),

(2, 'Proud to see so many of our alumni making waves in the tech industry. The network keeps growing stronger!', 'announcement'),

(3, 'New blog post: "10 Essential Python Libraries for Data Science" - check it out on my LinkedIn profile.', 'update'),

(8, 'Speaking at the Startup Pitch Night event. Come see what we''re building in the fintech space!', 'event');
